<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lua Obfuscator | v2.04.3</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Source Code Pro', monospace;
        margin: 0;
        background: #000;
        color: #eee;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        overflow-x: hidden;
    }

    .container {
        display: none;
        flex-direction: column;
        width: 85%;
        max-width: 900px;
        padding: 40px;
        border-radius: 12px;
        background: #111;
        box-shadow: 0 10px 20px rgba(0,0,0,0.8);
    }

    h1 {
        text-align: center;
        color: #e74c3c;
        font-size: 2.5em;
        margin-bottom: 30px;
    }

    .code-area-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .code-area h2 {
        color: #e86353;
        margin-bottom: 8px;
        font-weight: 500;
    }

    textarea, #output {
        width: 100%;
        height: 250px;
        padding: 15px;
        border-radius: 8px;
        border: 1px solid #555;
        background: #222;
        color: #eee;
        font-family: inherit;
        resize: none;
        overflow: auto;
        transition: border-color 0.3s, box-shadow 0.3s;
    }

    textarea:focus, #output:focus {
        border-color: #e74c3c;
        box-shadow: 0 0 0 0.2rem rgba(231,76,60,0.25);
        outline: none;
    }

    .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: 20px;
    }

    .button-group, .dropdown {
        display: flex;
        gap: 10px;
    }

    button, .dropdown button {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        font-size: 1em;
        border-radius: 6px;
        border: none;
        cursor: pointer;
        background-color: #c0392b;
        color: #fff;
        transition: 0.3s;
    }

    button:hover, .dropdown:hover button {
        background-color: #d64537;
        transform: translateY(-1px);
    }

    #clearButton { background: #333; }
    #clearButton:hover { background: #444; }

    #loadingIndicator { display: none; margin-left: 15px; animation: spin 0.8s linear infinite; }

    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    .dropdown { position: relative; }
    .dropdown-content {
        display: none;
        position: absolute;
        background: #222;
        min-width: 160px;
        border-radius: 6px;
        box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        overflow: hidden;
        z-index: 3;
    }

    .dropdown-content a {
        color: #eee;
        padding: 10px 14px;
        text-decoration: none;
        display: block;
    }

    .dropdown-content a:hover { background: #444; }
    .dropdown:hover .dropdown-content { display: block; }

    #output { opacity: 1; transition: opacity 0.3s; }
    #output.fade-out { opacity: 0; }

    #intro, #mini-menu {
        position: fixed;
        z-index: 10;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #intro {
        top:0; left:0; width:100%; height:100%;
        background:#000;
        animation: fadeOut 1s ease 3s forwards;
    }

    #intro-title {
        font-size: 4em;
        font-weight: 700;
        color:#e74c3c;
        text-shadow:0 0 10px #e74c3c;
        animation: flicker 0.5s infinite alternate, zoomIn 1.5s ease forwards;
    }

    @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
    @keyframes flicker { from { opacity:0.8 } to { opacity:1 } }
    @keyframes zoomIn { from { transform:scale(0) } to { transform:scale(1) } }

    #mini-menu {
        top: 20px; left: 20px;
        background: rgba(34,34,34,0.9);
        padding: 15px;
        border-radius: 8px;
        color: #eee;
        box-shadow: 0 4px 8px rgba(0,0,0,0.5);
        display: none;
        animation: popUp 0.5s forwards, fadeOutSlow 1s ease 5s forwards;
    }

    #mini-menu-title { font-weight: bold; margin-bottom: 5px; color: #e74c3c; }
    #mini-menu p { margin:0 0 10px 0; font-size:0.9em; }
    #mini-menu p:last-child { font-size:0.7em; color:#aaa; margin-bottom:0; }

    @keyframes popUp { from { transform:scale(0); opacity:0 } to { transform:scale(1); opacity:1 } }
    @keyframes fadeOutSlow { to { opacity:0; visibility:hidden } }
</style>
</head>
<body>

<div id="intro"><div id="intro-title">Lua Obfuscator | @vxpe_injected on Discord | v.2.04.3</div></div>

<div id="mini-menu">
    <div id="mini-menu-title">Note!</div>
    <p>Made By @vxpe_injected on Discord, Follow me for more</p>
    <p>psst.. I've been working On this for ages</p>
</div>

<div class="container">
    <h1><i class="fas fa-magic"></i>Lua Obfuscator</h1>

    <div class="code-area-container">
        <div class="code-area">
            <h2><i class="fas fa-file-code"></i> Input</h2>
            <textarea id="inputCode" placeholder="Paste your Lua code here..."></textarea>
        </div>
        <div class="code-area">
            <h2><i class="fas fa-lock"></i> Output</h2>
            <div id="output"></div>
        </div>
    </div>

    <div class="controls">
        <div class="button-group">
            <button id="obfuscateButton" onclick="obfuscateCode()"><i class="fas fa-shield-alt"></i> Obfuscate</button>
            <button id="clearButton" onclick="clearFields()"><i class="fas fa-trash-alt"></i> Clear</button>
            <button id="preserveFunctionalityButton" onclick="togglePreserveFunctionality()">
                <i class="fas fa-check-circle"></i> Preserve Functionality: <span id="preserveStatus">OFF</span>
            </button>
        </div>

        <div class="dropdown">
            <button id="protectionLevelButton"><i class="fas fa-user-secret"></i> Protection Level</button>
            <div class="dropdown-content">
                <a href="#" onclick="setProtectionLevel('none')">None</a>
                <a href="#" onclick="setProtectionLevel('low')">Low</a>
                <a href="#" onclick="setProtectionLevel('normal')">Normal</a>
                <a href="#" onclick="setProtectionLevel('advanced')">Advanced</a>
                <a href="#" onclick="setProtectionLevel('extreme')">Extreme</a>
            </div>
        </div>

        <div class="dropdown">
            <button id="antiReverseEngineeringButton"><i class="fas fa-wrench"></i> Anti-Reverse Engineering</button>
            <div class="dropdown-content">
                <a href="#" onclick="setAntiReverseEngineering('none')">None</a>
                <a href="#" onclick="setAntiReverseEngineering('basic')">Basic</a>
                <a href="#" onclick="setAntiReverseEngineering('complex')">Complex</a>
                <a href="#" onclick="setAntiReverseEngineering('extreme')">Extreme</a>
            </div>
        </div>

        <span id="loadingIndicator"><i class="fas fa-spinner"></i></span>
    </div>
</div>

<script>
let protectionLevel = 'none';
let antiReverseEngineering = 'none';
let preserveFunctionality = false;

document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
        document.querySelector('.container').style.display = 'flex';
        document.getElementById('mini-menu').style.display = 'block';
    }, 4000);
    updateButtonText();
});

function updateButtonText() {
    document.getElementById('protectionLevelButton').innerHTML = `<i class="fas fa-user-secret"></i> ${capitalize(protectionLevel)} Protection`;
    document.getElementById('antiReverseEngineeringButton').innerHTML = `<i class="fas fa-wrench"></i> ${capitalize(antiReverseEngineering)}`;
}

function capitalize(str) { return str.charAt(0).toUpperCase() + str.slice(1); }

function setProtectionLevel(level) { protectionLevel = level; updateButtonText(); }
function setAntiReverseEngineering(level) { antiReverseEngineering = level; updateButtonText(); }

function togglePreserveFunctionality() {
    preserveFunctionality = !preserveFunctionality;
    const btn = document.getElementById('preserveFunctionalityButton');
    document.getElementById('preserveStatus').textContent = preserveFunctionality ? 'ON' : 'OFF';
    btn.style.backgroundColor = preserveFunctionality ? '#2ecc71' : '#c0392b';
    btn.innerHTML = `<i class="fas ${preserveFunctionality ? 'fa-check-circle' : 'fa-times-circle'}"></i> Preserve Functionality: <span id="preserveStatus">${preserveFunctionality ? 'ON' : 'OFF'}</span>`;
}

function obfuscateCode() {
    const loading = document.getElementById('loadingIndicator');
    const output = document.getElementById('output');
    output.classList.add('fade-out');
    loading.style.display = 'inline-block';

    setTimeout(() => {
        let code = document.getElementById('inputCode').value;
        code = applyObfuscation(code, protectionLevel, antiReverseEngineering);
        output.textContent = addObfuscationMessage(code);
        output.classList.remove('fade-out');
        loading.style.display = 'none';
    }, 300);
}

function clearFields() {
    document.getElementById('inputCode').value = '';
    document.getElementById('output').textContent = '';
}

function applyObfuscation(code, level, antiReverse) {
    let obf = code;
    if (level !== 'none' || antiReverse !== 'none') {
        obf = obfuscateLocalVariables(obf);
        obf = removeComments(obf);
        obf = safeRemoveWhitespace(obf);
        obf = convertNumbersToHex(obf);
    }

    const levels = {
        low: [stringManipulation, basicControlFlowObfuscation],
        normal: [stringManipulation, basicControlFlowObfuscation, (c)=>deadCodeInsertion(c,preserveFunctionality), aggressiveRenaming],
        advanced: [stringManipulation, basicControlFlowObfuscation, (c)=>deadCodeInsertion(c,preserveFunctionality), aggressiveRenaming, booleanObfuscation, numberObfuscation],
        extreme: [stringManipulation, advancedControlFlowObfuscation, (c)=>deadCodeInsertion(c,preserveFunctionality), aggressiveRenaming, booleanObfuscation, numberObfuscation, dataObfuscation, functionInlining]
    };

    if(levels[level]) levels[level].forEach(fn => obf = fn(obf));

    const anti = {
        basic: [basicControlFlowObfuscation],
        complex: [advancedControlFlowObfuscation, dataObfuscation, functionInlining],
        extreme: [advancedControlFlowObfuscation, dataObfuscation, functionInlining, (c)=>junkCodeInsertion(c,preserveFunctionality), aggressiveRenaming, booleanObfuscation, numberObfuscation]
    };

    if(anti[antiReverse]) anti[antiReverse].forEach(fn => { if(typeof fn==='function') obf=fn(obf); });

    return obf;
}

// --- Techniques ---
function obfuscateLocalVariables(code) {
    const regex = /local\s+([a-zA-Z_]\w*)/g;
    const replacements = {};
    let obf = code;
    let m;
    while(m = regex.exec(code)){
        const name = m[1];
        if(!replacements[name]){
            const newName = `_0x${Math.random().toString(16).slice(2,8)}${Math.random().toString(16).slice(2,8)}`;
            replacements[name] = newName;
            obf = obf.replace(new RegExp(`\\b${name}\\b`,'g'), newName);
        }
    }
    return obf;
}

function removeComments(code){ return code.replace(/--\[\[[\s\S]*?\]\]/g,'').replace(/--.*$/gm,''); }

function safeRemoveWhitespace(code){
    let inStr=false, newC="";
    for(let i=0;i<code.length;i++){
        const c=code[i];
        if(c=='"'||c=="'"){
            if(code[i-1]==='\\') newC+=c;
            else { inStr=!inStr; newC+=c; }
        } else if(!inStr && /\s/.test(c)) continue;
        else newC+=c;
    }
    return newC;
}

function convertNumbersToHex(code){
    return code.replace(/\b-?\d+(\.\d+)?\b/g, m=>{
        const hex = parseFloat(m).toString(16);
        return hex.startsWith('-') ? `-0x${hex.slice(1)}` : `0x${hex}`;
    });
}

function stringManipulation(code){ 
    return code.replace(/"([^"\\]*(?:\\.[^"\\]*)*)"/g,(m,s)=>`string.char(${[...s].map(c=>c.charCodeAt(0)).join(',')})`);
}

function basicControlFlowObfuscation(code){ return code.replace(/;/g,";if true then end;"); }

// --- Fixed Advanced Control Flow ---
function advancedControlFlowObfuscation(code){
    const a = generateObfuscatedName(), b = generateObfuscatedName();
    return `do local ${a}=0; local ${b}=1; if ${a}<${b} then while ${a}<${b} do ${a}=${a}+1; ${b}=${b}+1; end end end\n` + code;
}

// --- Junk & Dead Code ---
function deadCodeInsertion(code,preserve){ 
    if(preserve) return code;
    const f = generateObfuscatedName();
    return `local function ${f}() local ${generateObfuscatedName()}=10; end\n` + code; 
}

function junkCodeInsertion(code,preserve){
    if(preserve) return code;
    const stmts = [
        `local ${generateObfuscatedName()}=1+1-1`,
        `if true then end`,
        `local ${generateObfuscatedName()}=string.char(72,101,108,108,111)`,
        `local ${generateObfuscatedName()}={${generateObfuscatedName()}=1}`
    ];
    return stmts[Math.floor(Math.random()*stmts.length)] + '\n' + code;
}

// --- Function Inlining Fix ---
function functionInlining(code){
    return code.replace(/local function ([a-zA-Z_]\w*)\(([^)]*)\)\s*([\s\S]*?)end/g,(m,n,p,b)=>{
        // Only inline simple single-line returns
        const body = b.trim();
        if(body.startsWith('return ')){
            const expr = body.slice(7).trim();
            const callRegex = new RegExp(`\\b${n}\\s*\\(([^)]*)\\)`, 'g');
            return code.replace(callRegex, `(${expr})`);
        }
        return m;
    });
}

// --- Aggressive Renaming Fix ---
function aggressiveRenaming(code){
    return code.replace(/\b([a-zA-Z_]\w*)\b/g,name=>isLuaKeyword(name)||isLuaStdLib(name)?name:generateObfuscatedName());
}
function isLuaKeyword(n){ return ["and","break","do","else","elseif","end","false","for","function","if","in","local","nil","not","or","repeat","return","then","true","until","while"].includes(n); }
function isLuaStdLib(n){ return ["string","table","math","io","os","debug","coroutine","package"].some(k=>n===k||n.startsWith(k+".")); }

// --- Boolean & Number ---
function booleanObfuscation(code){ return code.replace(/\btrue\b/g,"(1==1)").replace(/\bfalse\b/g,"(1==0)"); }
function numberObfuscation(code){ return code.replace(/\b-?\d+(\.\d+)?\b/g,m=>["("+m+"+0)","("+m+"*1)","("+m+"-0)","("+m+"/1)","("+m+"^1)"][Math.floor(Math.random()*5)]); }
function dataObfuscation(code){ const offset=Math.floor(Math.random()*100)+1; return code.replace(/\b-?\d+(\.\d+)?\b/g,m=>`(${m}+${offset}-${offset})`); }

// --- Utilities ---
function addObfuscationMessage(code){ return "--[[ Obfuscated & Protected By VxpeInjected.Lua_Obfuscator v.2.04.3 ]]--\n"+code; }
function generateObfuscatedName(){ return `_0x${Math.random().toString(16).slice(2,8)}${Math.random().toString(16).slice(2,8)}`; }
</script>
</body>
</html>

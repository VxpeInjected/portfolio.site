<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lua Obfuscator</title>
  <style>
    body { background:#0f0f0f; color:#fff; font-family:Arial; margin:0; padding:0; }
    .tabs { display:flex; background:#1a1a1a; }
    .tab { padding:15px 25px; cursor:pointer; border-right:1px solid #333; }
    .tab.active { background:#333; }
    .page { display:none; padding:20px; }
    .page.active { display:block; }
    textarea { width:100%; height:300px; background:#111; color:#0f0; border:1px solid #333; padding:10px; font-family:monospace; }
    button { padding:10px 15px; background:#0f0; border:none; cursor:pointer; font-weight:bold; color:#000; margin-top:10px; }
    #loader { width:0%; height:8px; background:#0f0; margin-top:10px; transition:width .3s; }
  </style>
</head>
<body>
  <div class="tabs">
    <div class="tab active" data-page="obf">Obfuscate</div>
    <div class="tab" data-page="deobf">Deobfuscate</div>
  </div>

  <div id="loader"></div>

  <div id="obf" class="page active">
    <h2>Lua Obfuscator</h2>
    <textarea id="inputObf" placeholder="Paste Lua code here..."></textarea>
    <button id="btnObf">Obfuscate</button>
    <textarea id="outputObf" placeholder="Obfuscated output..." readonly></textarea>
  </div>

  <div id="deobf" class="page">
    <h2>Lua Deobfuscator</h2>
    <textarea id="inputDeobf" placeholder="Paste obfuscated code..."></textarea>
    <button id="btnDeobf">Deobfuscate</button>
    <textarea id="outputDeobf" placeholder="Deobfuscated output..." readonly></textarea>
  </div>

<script>
// Page switching
const tabs = document.querySelectorAll('.tab');
const pages = document.querySelectorAll('.page');

tabs.forEach(t => {
  t.onclick = () => {
    tabs.forEach(x => x.classList.remove('active'));
    t.classList.add('active');
    pages.forEach(p => p.classList.remove('active'));
    document.getElementById(t.dataset.page).classList.add('active');
  };
});

// Loader bar function
function runLoader(callback){
  const bar = document.getElementById('loader');
  bar.style.width = '0%';
  let w = 0;
  const interval = setInterval(()=>{
    w += 10;
    bar.style.width = w + '%';
    if(w >= 100){ clearInterval(interval); setTimeout(()=>{ bar.style.width = '0%' },300); callback(); }
  }, 60);
}

// Simple reversible obfuscator
function obfuscate(code){
  const map = {};
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  let result = '';
  for(let c of code){
    if(!map[c]) map[c] = chars[Math.floor(Math.random()*chars.length)];
    result += map[c];
  }
  return '--MAP:' + btoa(JSON.stringify(map)) + '\n' + result;
}

function deobfuscate(code){
  const lines = code.split('\n');
  if(!lines[0].startsWith('--MAP:')) return 'Missing MAP header';
  let map = JSON.parse(atob(lines[0].slice(6)));
  let reverse = {};
  for(let k in map) reverse[map[k]] = k;
  let out = '';
  const body = lines.slice(1).join('\n');
  for(let c of body) out += reverse[c] || c;
  return out;
}

// Buttons

document.getElementById('btnObf').onclick = () => {
  runLoader(()=>{
    const input = document.getElementById('inputObf').value;
    document.getElementById('outputObf').value = obfuscate(input);
  });
};

document.getElementById('btnDeobf').onclick = () => {
  runLoader(()=>{
    const input = document.getElementById('inputDeobf').value;
    document.getElementById('outputDeobf').value = deobfuscate(input);
  });
};
</script>
</body>
</html>
